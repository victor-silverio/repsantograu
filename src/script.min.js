document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("mobile-menu-btn"),t=document.getElementById("mobile-menu");if(e&&t){e.addEventListener("click",()=>{const o="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!o),t.classList.toggle("hidden")});t.querySelectorAll("a").forEach(o=>{o.addEventListener("click",()=>{t.classList.add("hidden"),e.setAttribute("aria-expanded","false")})})}const o=document.querySelectorAll(".reveal");if(o.length>0){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("active"),e.unobserve(t.target))})},{threshold:.15,rootMargin:"0px 0px -50px 0px"});o.forEach(t=>e.observe(t))}if((()=>{const e=document.getElementById("timeline-carousel"),t=document.getElementById("scroll-left"),o=document.getElementById("scroll-right");if(e){const n=e.querySelectorAll(".snap-center");let s=!1;const r=()=>{t&&o&&(s||(window.requestAnimationFrame(()=>{const n=e.scrollLeft,r=e.scrollWidth-e.clientWidth-20;t.style.opacity=n>20?"1":"0",o.style.opacity=n<r?"1":"0",s=!1}),s=!0))};e.addEventListener("scroll",r),window.addEventListener("resize",r),r(),t&&o&&(t.addEventListener("click",()=>{const t=n[0].offsetWidth+24;e.scrollBy({left:-t,behavior:"smooth"})}),o.addEventListener("click",()=>{const t=n[0].offsetWidth+24;e.scrollBy({left:t,behavior:"smooth"})}));let a,i,c=!1;e.querySelectorAll("img").forEach(e=>e.setAttribute("draggable","false")),e.addEventListener("pointerdown",t=>{"mouse"===t.pointerType&&(c=!0,t.preventDefault(),e.setPointerCapture(t.pointerId),e.classList.add("cursor-grabbing"),e.classList.remove("cursor-grab","snap-x","snap-mandatory","scroll-smooth"),a=t.pageX-e.offsetLeft,i=e.scrollLeft)});const l=t=>{if(!c)return;if("mouse"!==t.pointerType)return;c=!1,e.releasePointerCapture(t.pointerId),e.classList.remove("cursor-grabbing");const o=e.scrollLeft+e.clientWidth/2;let s=null,r=1/0;n.forEach(e=>{const t=e.offsetLeft+e.offsetWidth/2,n=Math.abs(o-t);n<r&&(r=n,s=e)}),s&&s.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"}),setTimeout(()=>{e.classList.add("cursor-grab","snap-x","snap-mandatory","scroll-smooth")},600)};let d;e.addEventListener("pointerleave",l),e.addEventListener("pointerup",l),e.addEventListener("pointercancel",l),e.addEventListener("pointermove",t=>{if(!c)return;if("mouse"!==t.pointerType)return;t.preventDefault();const o=1.5*(t.pageX-e.offsetLeft-a);e.scrollLeft=i-o}),e.addEventListener("touchend",()=>{c=!1,e.classList.remove("cursor-grabbing"),e.classList.add("cursor-grab","snap-x","snap-mandatory","scroll-smooth")}),e.addEventListener("touchmove",t=>{c&&(d&&cancelAnimationFrame(d),d=requestAnimationFrame(()=>{const o=2*(t.touches[0].pageX-e.offsetLeft-a);e.scrollLeft=i-o}))},{passive:!0})}})(),"serviceWorker"in navigator){const e=()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("Service Worker registrado com sucesso:",e.scope),e.update().catch(e=>console.log("Falha ao atualizar SW:",e))}).catch(e=>{console.log("Falha ao registrar Service Worker:",e)})};window.addEventListener("load",()=>{"requestIdleCallback"in window?requestIdleCallback(e):e()})}const n=document.getElementById("lightbox"),s=document.getElementById("lightbox-img"),r=document.getElementById("lightbox-caption"),a=document.getElementById("lightbox-close"),i=document.getElementById("lightbox-prev"),c=document.getElementById("lightbox-next"),l=document.querySelectorAll(".gallery-img");if(n&&l.length>0){let e=0;const t=Array.from(l),o=o=>{e=o;const a=t[e];s.src=a.getAttribute("data-full")||a.src,r.textContent=a.getAttribute("alt")||"",n.classList.remove("hidden"),setTimeout(()=>{n.classList.remove("opacity-0")},10),document.body.style.overflow="hidden"},d=()=>{n.classList.add("opacity-0"),setTimeout(()=>{n.classList.add("hidden"),s.src=""},300),document.body.style.overflow=""},u=()=>{e=(e+1)%t.length,o(e)},m=()=>{e=(e-1+t.length)%t.length,o(e)};t.forEach((e,t)=>{e.addEventListener("click",()=>o(t))}),a.addEventListener("click",d),n.addEventListener("click",e=>{e.target===n&&d()}),c?.addEventListener("click",e=>{e.stopPropagation(),u()}),i?.addEventListener("click",e=>{e.stopPropagation(),m()}),document.addEventListener("keydown",e=>{n.classList.contains("hidden")||("Escape"===e.key&&d(),"ArrowRight"===e.key&&u(),"ArrowLeft"===e.key&&m())});let g=0,h=0;n.addEventListener("touchstart",e=>{g=e.changedTouches[0].screenX},{passive:!0}),n.addEventListener("touchend",e=>{h=e.changedTouches[0].screenX,v()},{passive:!0});const v=()=>{h<g-50&&u(),h>g+50&&m()}}});