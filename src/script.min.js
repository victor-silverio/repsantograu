document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("mobile-menu-btn"),t=document.getElementById("mobile-menu");if(e&&t){e.addEventListener("click",()=>{const o="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!o),t.classList.toggle("hidden")});t.querySelectorAll("a").forEach(o=>{o.addEventListener("click",()=>{t.classList.add("hidden"),e.setAttribute("aria-expanded","false")})})}const o=document.querySelectorAll(".reveal");if(o.length>0){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("active"),e.unobserve(t.target))})},{threshold:.15,rootMargin:"0px 0px -50px 0px"});o.forEach(t=>e.observe(t))}(()=>{const e=document.getElementById("timeline-carousel"),t=document.getElementById("scroll-left"),o=document.getElementById("scroll-right");if(e){const s=e.querySelectorAll(".snap-center");let n=!1;const r=()=>{t&&o&&(n||(window.requestAnimationFrame(()=>{const s=e.scrollLeft,r=e.scrollWidth-e.clientWidth-20;t.style.opacity=s>20?"1":"0",o.style.opacity=s<r?"1":"0",n=!1}),n=!0))};e.addEventListener("scroll",r),window.addEventListener("resize",r),r(),t&&o&&(t.addEventListener("click",()=>{const t=s[0].offsetWidth+24;e.scrollBy({left:-t,behavior:"smooth"})}),o.addEventListener("click",()=>{const t=s[0].offsetWidth+24;e.scrollBy({left:t,behavior:"smooth"})}));let a,i,c=!1;e.querySelectorAll("img").forEach(e=>e.setAttribute("draggable","false")),e.addEventListener("pointerdown",t=>{"mouse"===t.pointerType&&(c=!0,t.preventDefault(),e.setPointerCapture(t.pointerId),e.classList.add("cursor-grabbing"),e.classList.remove("cursor-grab","snap-x","snap-mandatory","scroll-smooth"),a=t.pageX-e.offsetLeft,i=e.scrollLeft)});const l=t=>{if(!c)return;if("mouse"!==t.pointerType)return;c=!1,e.releasePointerCapture(t.pointerId),e.classList.remove("cursor-grabbing");const o=e.scrollLeft+e.clientWidth/2;let n=null,r=1/0;s.forEach(e=>{const t=e.offsetLeft+e.offsetWidth/2,s=Math.abs(o-t);s<r&&(r=s,n=e)}),n&&n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"}),setTimeout(()=>{e.classList.add("cursor-grab","snap-x","snap-mandatory","scroll-smooth")},600)};let d;e.addEventListener("pointerleave",l),e.addEventListener("pointerup",l),e.addEventListener("pointercancel",l),e.addEventListener("pointermove",t=>{if(!c)return;if("mouse"!==t.pointerType)return;t.preventDefault();const o=1.5*(t.pageX-e.offsetLeft-a);e.scrollLeft=i-o}),e.addEventListener("touchend",()=>{c=!1,e.classList.remove("cursor-grabbing"),e.classList.add("cursor-grab","snap-x","snap-mandatory","scroll-smooth")}),e.addEventListener("touchmove",t=>{c&&(d&&cancelAnimationFrame(d),d=requestAnimationFrame(()=>{const o=2*(t.touches[0].pageX-e.offsetLeft-a);e.scrollLeft=i-o}))},{passive:!0})}})();const s=document.getElementById("back-to-top");if(s&&(window.addEventListener("scroll",()=>{window.scrollY>500?(s.classList.remove("opacity-0"),s.classList.add("opacity-100"),s.style.pointerEvents="auto"):(s.classList.remove("opacity-100"),s.classList.add("opacity-0"),s.style.pointerEvents="none")}),s.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})),"serviceWorker"in navigator){const e=()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("Service Worker registrado com sucesso:",e.scope),e.update().catch(e=>console.log("Falha ao atualizar SW:",e))}).catch(e=>{console.log("Falha ao registrar Service Worker:",e)})};window.addEventListener("load",()=>{const t=()=>{setTimeout(()=>{e()},2e3)};"requestIdleCallback"in window?requestIdleCallback(t):t()})}const n=document.getElementById("lightbox"),r=document.getElementById("lightbox-img"),a=document.getElementById("lightbox-caption"),i=document.getElementById("lightbox-close"),c=document.getElementById("lightbox-prev"),l=document.getElementById("lightbox-next"),d=document.querySelectorAll(".gallery-img");if(n&&d.length>0){let e=0;const t=Array.from(d),o=o=>{e=o;const s=t[e];r.src=s.getAttribute("data-full")||s.src,a.textContent=s.getAttribute("alt")||"",n.classList.remove("hidden"),setTimeout(()=>{n.classList.remove("opacity-0")},10),document.body.style.overflow="hidden"},s=()=>{n.classList.add("opacity-0"),setTimeout(()=>{n.classList.add("hidden"),r.src=""},300),document.body.style.overflow=""},u=()=>{e=(e+1)%t.length,o(e)},m=()=>{e=(e-1+t.length)%t.length,o(e)};t.forEach((e,t)=>{e.addEventListener("click",()=>o(t))}),i.addEventListener("click",s),n.addEventListener("click",e=>{e.target===n&&s()}),l?.addEventListener("click",e=>{e.stopPropagation(),u()}),c?.addEventListener("click",e=>{e.stopPropagation(),m()}),document.addEventListener("keydown",e=>{n.classList.contains("hidden")||("Escape"===e.key&&s(),"ArrowRight"===e.key&&u(),"ArrowLeft"===e.key&&m())});let g=0,v=0;n.addEventListener("touchstart",e=>{g=e.changedTouches[0].screenX},{passive:!0}),n.addEventListener("touchend",e=>{v=e.changedTouches[0].screenX,h()},{passive:!0});const h=()=>{v<g-50&&u(),v>g+50&&m()}}});