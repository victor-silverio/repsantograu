document.addEventListener("DOMContentLoaded",()=>{(async()=>{try{const e=await fetch("src/vagas.json");if(!e.ok)throw new Error("Falha ao carregar vagas.json");const t=await e.json(),{year:n,total_slots:s,occupied_slots:a,room_type:o}=t,r=s-a,l=document.getElementById("vacancy-badge");l&&(r>0?(l.className="animate-fadeIn mb-6 inline-flex items-center gap-2 rounded-full border border-white/20 bg-white/10 px-4 py-2 backdrop-blur-md",l.innerHTML=`\n              <span class="relative flex h-3 w-3">\n                <span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75"></span>\n                <span class="relative inline-flex h-3 w-3 rounded-full bg-green-500"></span>\n              </span>\n              <span class="font-sans text-sm font-medium tracking-wide text-white md:text-base">${r} Vagas Disponíveis para ${n}</span>\n            `):(l.className="animate-fadeIn mb-6 inline-flex items-center gap-2 rounded-full border border-red-500/30 bg-red-500/20 px-4 py-2 backdrop-blur-md",l.innerHTML=`\n              <span class="relative flex h-3 w-3">\n                <span class="relative inline-flex h-3 w-3 rounded-full bg-red-500"></span>\n              </span>\n              <span class="font-sans text-sm font-medium tracking-wide text-white md:text-base">Vagas Esgotadas para ${n}</span>\n            `));const i=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null,!1);let c;for(;c=i.nextNode();)if(c.nodeValue.includes("Atualmente as vagas são para")){const e=/Atualmente as vagas são para.*?\./;c.nodeValue=c.nodeValue.replace(e,`Atualmente as vagas são para ${o}.`)}}catch(e){console.error("Erro ao atualizar vagas:",e)}})();const e=document.getElementById("mobile-menu-btn"),t=document.getElementById("mobile-menu");if(e&&t){e.addEventListener("click",()=>{const n="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!n),t.classList.toggle("hidden")});t.querySelectorAll("a").forEach(n=>{n.addEventListener("click",()=>{t.classList.add("hidden"),e.setAttribute("aria-expanded","false")})})}const n=document.querySelectorAll(".reveal");if(n.length>0){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("active"),e.unobserve(t.target))})},{threshold:.2,root:null,rootMargin:"0px 0px -50px 0px"});n.forEach(t=>e.observe(t))}(()=>{const e=document.getElementById("timeline-carousel"),t=document.getElementById("scroll-left"),n=document.getElementById("scroll-right");if(e){const s=e.querySelectorAll(".snap-center");let a=!1;const o=()=>{t&&n&&(a||(window.requestAnimationFrame(()=>{const s=e.scrollLeft,o=e.scrollWidth-e.clientWidth-20;t.style.opacity=s>20?"1":"0",n.style.opacity=s<o?"1":"0",a=!1}),a=!0))};e.addEventListener("scroll",o),window.addEventListener("resize",o),o(),t&&n&&(t.addEventListener("click",()=>{const t=s[0].offsetWidth+24;e.scrollBy({left:-t,behavior:"smooth"})}),n.addEventListener("click",()=>{const t=s[0].offsetWidth+24;e.scrollBy({left:t,behavior:"smooth"})}));let r,l,i=!1;e.querySelectorAll("img").forEach(e=>e.setAttribute("draggable","false")),e.addEventListener("pointerdown",t=>{"mouse"===t.pointerType&&(i=!0,t.preventDefault(),e.setPointerCapture(t.pointerId),e.classList.add("cursor-grabbing"),e.classList.remove("cursor-grab","snap-x","snap-mandatory","scroll-smooth"),r=t.pageX-e.offsetLeft,l=e.scrollLeft)});const c=t=>{if(!i)return;if("mouse"!==t.pointerType)return;i=!1,e.releasePointerCapture(t.pointerId),e.classList.remove("cursor-grabbing");const n=e.scrollLeft+e.clientWidth/2;let a=null,o=1/0;s.forEach(e=>{const t=e.offsetLeft+e.offsetWidth/2,s=Math.abs(n-t);s<o&&(o=s,a=e)}),a&&a.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"}),setTimeout(()=>{e.classList.add("cursor-grab","snap-x","snap-mandatory","scroll-smooth")},600)};let d;e.addEventListener("pointerleave",c),e.addEventListener("pointerup",c),e.addEventListener("pointercancel",c),e.addEventListener("pointermove",t=>{if(!i)return;if("mouse"!==t.pointerType)return;t.preventDefault();const n=1.5*(t.pageX-e.offsetLeft-r);e.scrollLeft=l-n}),e.addEventListener("touchstart",t=>{i=!0,e.classList.add("cursor-grabbing"),e.classList.remove("cursor-grab","snap-x","snap-mandatory","scroll-smooth"),r=t.touches[0].pageX-e.offsetLeft,l=e.scrollLeft},{passive:!0}),e.addEventListener("touchend",()=>{i=!1,e.classList.remove("cursor-grabbing"),e.classList.add("cursor-grab","snap-x","snap-mandatory","scroll-smooth")}),e.addEventListener("touchmove",t=>{i&&(d&&cancelAnimationFrame(d),d=requestAnimationFrame(()=>{const n=2*(t.touches[0].pageX-e.offsetLeft-r);e.scrollLeft=l-n}))},{passive:!0})}})();const s=document.getElementById("back-to-top");if(s&&(window.addEventListener("scroll",()=>{window.scrollY>500?(s.classList.remove("opacity-0"),s.classList.add("opacity-100"),s.style.pointerEvents="auto"):(s.classList.remove("opacity-100"),s.classList.add("opacity-0"),s.style.pointerEvents="none")}),s.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})),"serviceWorker"in navigator){const e=async(t=0)=>{try{const e=await navigator.serviceWorker.register("/sw.js");console.log("Service Worker registrado com sucesso:",e.scope);try{await e.update()}catch(e){console.log("Falha ao atualizar SW:",e)}}catch(n){console.warn(`Falha ao registrar Service Worker (tentativa ${t+1}):`,n),t<2?(console.log("Tentando novamente em 2 segundos..."),setTimeout(()=>e(t+1),2e3)):console.error("Falha crítica no registro do Service Worker após múltiplas tentativas. O site pode não funcionar offline.")}};window.addEventListener("load",()=>{const t=()=>{setTimeout(()=>{e()},2e3)};"requestIdleCallback"in window?requestIdleCallback(t):t()})}const a=document.getElementById("lightbox"),o=document.getElementById("lightbox-img"),r=document.getElementById("lightbox-caption"),l=document.getElementById("lightbox-close"),i=document.getElementById("lightbox-prev"),c=document.getElementById("lightbox-next"),d=document.querySelectorAll(".gallery-img");if(a&&d.length>0){let e=0;const t=Array.from(d),n=n=>{e=n;const s=t[e];o.src=s.getAttribute("data-full")||s.src,r.textContent=s.getAttribute("alt")||"",a.classList.remove("hidden"),setTimeout(()=>{a.classList.remove("opacity-0")},10),document.body.style.overflow="hidden"},s=()=>{a.classList.add("opacity-0"),setTimeout(()=>{a.classList.add("hidden"),o.src=""},300),document.body.style.overflow=""},u=()=>{e=(e+1)%t.length,n(e)},m=()=>{e=(e-1+t.length)%t.length,n(e)};t.forEach((e,t)=>{e.addEventListener("click",()=>n(t))}),l.addEventListener("click",s),a.addEventListener("click",e=>{e.target===a&&s()}),c?.addEventListener("click",e=>{e.stopPropagation(),u()}),i?.addEventListener("click",e=>{e.stopPropagation(),m()}),document.addEventListener("keydown",e=>{a.classList.contains("hidden")||("Escape"===e.key&&s(),"ArrowRight"===e.key&&u(),"ArrowLeft"===e.key&&m())});let p=0,g=0;a.addEventListener("touchstart",e=>{p=e.changedTouches[0].screenX},{passive:!0}),a.addEventListener("touchend",e=>{g=e.changedTouches[0].screenX,f()},{passive:!0});const f=()=>{g<p-50&&u(),g>p+50&&m()}}});